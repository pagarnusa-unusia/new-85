<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verifikasi Digital | Pagarnusa UNUSIA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        pn: '#166534',
                        neutral: { 850: '#1e293b' }
                    },
                    fontFamily: { sans: ['Inter', 'sans-serif'] }
                }
            }
        }
    </script>
    <style>
        body { background-color: #f8fafc; color: #1e293b; }
        .official-card { background: white; border: 1px solid #e2e8f0; border-top: 4px solid #166534; }
        .label-text { font-size: 0.65rem; font-weight: 700; color: #94a3b8; text-transform: uppercase; letter-spacing: 0.05em; }
        
        #loader {
            position: fixed; inset: 0; background: white; z-index: 50;
            display: flex; align-items: center; justify-content: center;
        }
    </style>
</head>
<body class="antialiased font-sans">

    <div id="loader">
        <div class="w-6 h-6 border-2 border-slate-200 border-t-pn rounded-full animate-spin"></div>
    </div>

    <main class="min-h-screen flex flex-col items-center justify-center px-4 py-10">
        
        <div class="mb-8 text-center">
            <img src="../logopn.png" alt="Pagarnusa UNUSIA" class="h-14 mx-auto mb-3">
            <h1 class="text-[10px] font-bold tracking-[0.2em] text-slate-400 uppercase leading-relaxed">
                Sistem Verifikasi Tanda Tangan<br>
                <span class="text-pn">Pagarnusa UNUSIA</span>
            </h1>
        </div>

        <div class="official-card w-full max-w-md rounded-xl shadow-sm overflow-hidden">
            
            <div class="px-8 py-10">
                <div class="flex items-center gap-2 mb-8 text-emerald-700 bg-emerald-50 w-fit px-3 py-1 rounded-full border border-emerald-100">
                    <i class="fas fa-check-circle text-[10px]"></i>
                    <span class="text-[10px] font-bold uppercase tracking-wider">Dokumen Valid</span>
                </div>

                <div class="space-y-8">
                    <div>
                        <p class="label-text mb-1">Nama Penandatangan</p>
                        <h2 id="v-nama" class="text-xl font-bold tracking-tight text-slate-850">---</h2>
                    </div>

                    <div>
                        <p class="label-text mb-1">Jabatan Resmi</p>
                        <p id="v-jabatan" class="text-sm font-medium text-slate-600 italic">---</p>
                    </div>

                    <div>
                        <p class="label-text mb-3">Tanda Tangan Elektronik</p>
                        <div class="bg-slate-50 border border-slate-100 rounded-lg p-5 flex justify-center items-center h-40">
                            <img id="v-signature" src="" alt="Specimen" class="max-h-full max-w-full object-contain mix-blend-multiply grayscale hover:grayscale-0 transition-all duration-500">
                        </div>
                    </div>
                </div>

                <div class="mt-10 pt-8 border-t border-slate-100">
                    <div class="flex justify-between items-end">
                        <div class="space-y-1">
                            <p class="text-[9px] font-bold text-slate-400 uppercase tracking-tighter">Waktu Verifikasi</p>
                            <p id="v-time" class="text-[10px] font-medium text-slate-600">---</p>
                        </div>
                        <div class="text-right">
                            <p class="text-[9px] font-bold text-slate-400 uppercase tracking-tighter">ID Referensi</p>
                            <p id="v-cert-id" class="text-[10px] font-mono font-bold text-pn uppercase">---</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="bg-slate-50 px-8 py-4 border-t border-slate-100">
                <p class="text-[9px] text-slate-400 text-center leading-relaxed">
                    Data ini dihasilkan secara otomatis oleh sistem internal <strong>Pagarnusa UNUSIA</strong>. Segala bentuk pemalsuan data akan diproses sesuai ketentuan organisasi.
                </p>
            </div>
        </div>

        <button onclick="window.print()" class="mt-8 text-[10px] font-bold text-slate-400 hover:text-pn transition-all uppercase tracking-widest">
            <i class="fas fa-print mr-2"></i> Simpan Sebagai PDF
        </button>

    </main>

    <script>
    window.onload = async function() {
        const urlParams = new URLSearchParams(window.location.search);
        const id = urlParams.get('id');
        
        // Atur Waktu
        const now = new Date();
        document.getElementById('v-time').innerText = now.toLocaleString('id-ID', { 
            day: '2-digit', month: 'long', year: 'numeric', 
            hour: '2-digit', minute: '2-digit'
        }) + ' WIB';

        if (!id) {
            document.getElementById('v-nama').innerText = "DATA TIDAK DITEMUKAN";
            document.getElementById('loader').style.display = 'none';
            return;
        }

        document.getElementById('v-cert-id').innerText = id.substring(0, 8).toUpperCase();

        try {
            const response = await fetch("https://script.google.com/macros/s/AKfycbwZAuWq2BLMx5N84EYxGZ6UDPB3EglstTdz1r-wka1ibqSH2ZTipgRdlbqoXXPYW6y-UA/exec?id=" + id);
            const data = await response.json();

            if (data.nama) {
                document.getElementById('v-nama').innerText = data.nama;
                document.getElementById('v-jabatan').innerText = data.jabatan;
                document.getElementById('v-signature').src = data.image;
            } else {
                document.getElementById('v-nama').innerText = "ID TIDAK VALID";
            }
        } catch (err) {
            document.getElementById('v-nama').innerText = "KESALAHAN SISTEM";
        }
        
        // Hilangkan loader
        setTimeout(() => {
            document.getElementById('loader').style.opacity = '0';
            setTimeout(() => { document.getElementById('loader').style.display = 'none'; }, 400);
        }, 600);
    };
    </script>
</body>
</html>


